<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Ant – krotíme mravce | robonovotny</title>
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    <link rel="stylesheet" href="https://novotnyr.github.io/asciidoctor.css">
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0-rc.1/dist/katex.min.css" integrity="sha384-D+9gmBxUQogRLqvARvNLmA9hS2x//eK1FhVb9PiU86gmcrBrJAQT8okdJ4LMp2uv" crossorigin="anonymous">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.0-rc.1/dist/katex.min.js" integrity="sha384-483A6DwYfKeDa0Q52fJmxFXkcPCFfnXMoXblOkJ4JcA8zATN6Tm78UNL72AKk+0O" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.0-rc.1/dist/contrib/auto-render.min.js" integrity="sha384-yACMu8JWxKzSp/C1YV86pzGiQ/l1YUfE8oPuahJQxzehAjEt2GiQuy/BIvl9KyeF" crossorigin="anonymous"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            renderMathInElement(document.body);
        });
    </script>

<header>

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-light.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  <nav>
    <ul>
      
      
      <li class="pull-left ">
        <a href="https://novotnyr.github.io/">/home/robonovotny</a>
      </li>
      

      

    </ul>
  </nav>
</header>

  </head>

  <body>
    <br/>

<div class="article-meta">
<h1><span class="title">Ant – krotíme mravce</span></h1>

<h2 class="date">2007/11/13</h2>
<p class="terms">
  
  
  
  
  
</p>
</div>



<main>


<h1 id="čo-je-ant">Čo je Ant?</h1>

<p><a href="http://ant.apache.org">Apache Ant</a> je zostavovací nástroj založený na technológiách Javy. Jeho filozofia je veľmi podobná ideám z linuxového nástroja
<code>make</code>. Na rozdiel od tohto nástroja však Ant používa XML syntax a je platformovo nezávislý.</p>

<p>Ant zjednodušuje nudné a často opakované procesy prebiehajúce pri zostavovaní softvéru.
Typickým komplexným príkladom zostavovacieho procesu je cyklus „uprav – skompiluj – pribaľ serverovské konfiguráky – vyrob JAR – skopíruj na server“, ktorý je v manuálnom vykonávaní náchylný na chyby.</p>

<p>Ant umožňuje definovať rozdeliť zostavovanie na niekoľko (čiastkových) cieľov (<strong>targets</strong>), pričom na dosiahnutie každého cieľa je možné použiť niekoľko
preddefinovaných príkazov (zvaných <strong>tasks</strong> (<em>úlohy</em>, budeme však používať paslovenský termín <em>tasky</em>). Samotné jednotlivé ciele môžu byť navzájom
poprepájané závislosťami.</p>

<p>Nasledovný obrázok ukazuje štyri ciele, ktoré na sebe závisia. Každý z cieľov používa niekoľko taskov – napr. cieľ <em>vytvor JAR súbor</em> používa task
<code>jar</code> (pomocou ktorého je možné deklaratívne vytvoriť JAR súbor).</p>

<p><img src="ant-schema.gif" alt="" /></p>

<p>Celá deklarácia cieľov a používaných taskov je realizovaná pomocou XML (príkladov sa dočkáme nižšie). Samotný Ant ponúka značné množstvo preddefinovaných
taskov a mnohé ďalšie tasky sú k dispozícii od tretích strán. V prípade potreby nie je problém si vytvoriť v Jave vlastné tasky.</p>

<h1 id="inštalácia-antu-na-windowse">Inštalácia Antu na Windowse</h1>

<ol>
<li>stiahneme inštalačný ZIP súbor zo stránok</li>
<li>rozbalíme ho do vhodného adresára (napr. <code>C:\java\ant</code>)</li>
<li><code>bin</code> adresár pridáme do systémovej premennej <code>PATH</code> (napr. <code>C:\java\ant\bin</code>)</li>
<li>vytvoríme systémovú premennú <code>ANT_HOME</code> a nastavíme ju do adresára, kde je nainštalovaný Ant (napr. <code>C:\java\ant</code>).</li>
<li>pre istotu skontrolujeme, či je nastavená systémová premenná <code>JAVA_HOME</code> ukazujúca do adresára, kde je nainštalovaná JDK</li>
</ol>

<h1 id="začíname-s-antom">Začíname s Antom</h1>

<p>Voľne podľa originálu: <a href="http://ant.apache.org/manual/index.html">http://ant.apache.org/manual/index.html</a></p>

<p>Tento dokument predstavuje sprievodcu, ktorý vás prevedie úvodom
do práce so zostavovacím nástrojom Ant. Nevyžadujú sa žiadne
hlbšie znalosti práce s Javou či Antom. Cieľom tohto tutoriálu
je demonštrovať základné postupy pri práci s Antom.</p>

<h2 id="príprava-projektu-bez-antu">Príprava projektu (bez Antu)</h2>

<p>Predstavme si, že sme v situácii, keď nemáme po ruke žiadne integrované vývojové prostredie (teda žiadny Eclipse, NetBeans a pod.). Založenie projektu z
príkazového riadku si vyžaduje niekoľko krokov. Predovšetkým by sme chceli mať oddelené zdrojové kódy od skompilovaných <code>class</code> súborov. Súbory <code>.java</code>
teda uložíme do adresára <code>src</code>. Všetky vygenerované súbory budeme ukladať do adresára <code>build</code>, ktorý bude ďalej rozdelený na niekoľko podadresárov
určených pre výsledky zostavovania: adresár <code>classes</code> bude obsahovať skompilované súbory a <code>jar</code> výsledný JAR súbor.</p>

<p>Najprv vytvoríme adresár <code>src</code></p>

<pre><code>md src
</code></pre>

<p>Nasledovná jednoduchá trieda vypíše správu na štandardný výstup. Zdrojový
kód uložíme do adresára <code>src\oata\AhojSvet.java</code></p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#289;font-weight:bold">package</span> <span style="color:#5ed;font-weight:bold">oata</span>;

<span style="color:#289;font-weight:bold">public</span> <span style="color:#5ed;font-weight:bold">class</span> AhojSvet {
  <span style="color:#289;font-weight:bold">public</span> <span style="color:#5ed;font-weight:bold">static</span> <span style="color:#66f;font-weight:bold">void</span> <span style="color:#5ed;font-weight:bold">main</span>(String[] <span style="color:#5ed;font-weight:bold">args</span>) {
    System.<span style="color:#007">out</span>.<span style="color:#007">println</span>(<span style="background-color:#e0e0ff">&#34;Ahoj svet!&#34;</span>);
  }
}</code></pre></div>
<p>Triedu sa pokúsime skompilovať a spustiť:</p>

<pre><code>md build\classes
javac -sourcepath src -d build\classes src\oata\AhojSvet.java
java -cp build\classes oata.AhojSvet
</code></pre>

<p>čím získame výpis textu</p>

<pre><code>Ahoj svet!
</code></pre>

<p>Vytvorenie súboru JAR nie je náročné. Ale vytvorenie spustiteľného JAR súboru
vyžaduje niekoľko krokov navyše:</p>

<ul>
<li>vytvorenie <em>manifestu</em>, čo je konfiguračný súbor obsahujúci názov hlavnej spustiteľnej triedy</li>
<li>vytvorenie cieľového adresára pre JAR súbor</li>

<li><p>vytvorenie samotného JAR súboru, ktorý bude obsahovať súbory s triedami</p>

<pre><code>echo Main-Class: oata.AhojSvet&gt;manifest.txt
md build\jar
jar cfm build\jar\ahojsvet.jar manifest.txt -C build\classes .
java -jar build\jar\ahojsvet.jar
</code></pre>

<p><em>Pozn.</em> Okolo znaku <code>&gt;</code> v príkaze <code>echo Main-Class</code> nesmú byť medzery. V opačnom prípade
sa táto direktíva nezapíše do súboru správne!</p></li>
</ul>

<h2 id="štyri-kroky-pre-spustenie-aplikácie">Štyri kroky pre spustenie aplikácie</h2>

<p>V predošlom príklade sme vlastne zrealizovali zostavovací proces pozostávajúci zo štyroch krokov.
Naše zdrojáky sme museli <em>skompilovať</em>, inak by sme náš program nespustili. <em>Spustenie</em>, to
je ďalší krok. Okrem toho je užitočné našu aplikáciu pred uvoľnením do sveta <em>pripraviť na distribúciu</em>.
V našom prípade by sme mohli distribuovať len samotný <code>class</code> súbor. Ale ak by naša aplikácia
mala množstvo tried, a ešte vyžadovala súbory so závislosťami, užívateľov by nepotešilo, ak
by museli ručne ťahať stovky súborov. (Povedzme, že máme zložitú aplikáciu so swingovským grafickým
rozhraním - JAR súbor je v tomto prípade priam nutnosťou. A spustiteľný JAR súbor by veci
zjednodušil ešte viac&hellip;). Je viac než užitočné, aby sme v našom zostavovacom procese
mali možnosť začať vždy s čistým štítom - teda vymazať všetky skompilované súbory, vygenerované JAR
archívy a pod.</p>

<p>V Ante sa jednotlivé kroky zostavovacieho procesu (<em>build process</em>) nazývajú <em>cieľmi</em> (<em>targets</em>).
V príklade by sme mali teda štyri kroky:</p>

<ul>
<li><code>clean</code> &ndash; vymazanie adresára s výstupmi</li>
<li><code>compile</code> &ndash; skompilovanie zdrojákov</li>
<li><code>jar</code> &ndash; vytvorenie JAR súboru</li>
<li><code>run</code> &ndash; spustenie aplikácie</li>
</ul>

<p>Ciele sa v Ante definujú v zostavovacom súbore, ktorý sa štandardne volá <code>build.xml</code>. Vytvoríme
si teda tento súbor a uložíme ho do <code>.\build.xml</code>.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#070">&lt;project&gt;</span>

  <span style="color:#070">&lt;target</span> <span style="color:#007">name=</span><span style="background-color:#e0e0ff">&#34;clean&#34;</span><span style="color:#070">&gt;</span>
    <span style="color:#070">&lt;delete</span> <span style="color:#007">dir=</span><span style="background-color:#e0e0ff">&#34;build&#34;</span><span style="color:#070">/&gt;</span>
  <span style="color:#070">&lt;/target&gt;</span>

  <span style="color:#070">&lt;target</span> <span style="color:#007">name=</span><span style="background-color:#e0e0ff">&#34;compile&#34;</span><span style="color:#070">&gt;</span>
    <span style="color:#070">&lt;mkdir</span> <span style="color:#007">dir=</span><span style="background-color:#e0e0ff">&#34;build/classes&#34;</span><span style="color:#070">/&gt;</span>
    <span style="color:#070">&lt;javac</span> <span style="color:#007">srcdir=</span><span style="background-color:#e0e0ff">&#34;src&#34;</span> <span style="color:#007">destdir=</span><span style="background-color:#e0e0ff">&#34;build/classes&#34;</span><span style="color:#070">/&gt;</span>
  <span style="color:#070">&lt;/target&gt;</span>

  <span style="color:#070">&lt;target</span> <span style="color:#007">name=</span><span style="background-color:#e0e0ff">&#34;jar&#34;</span><span style="color:#070">&gt;</span>
    <span style="color:#070">&lt;mkdir</span> <span style="color:#007">dir=</span><span style="background-color:#e0e0ff">&#34;build/jar&#34;</span><span style="color:#070">/&gt;</span>
    <span style="color:#070">&lt;jar</span> <span style="color:#007">destfile=</span><span style="background-color:#e0e0ff">&#34;build/jar/ahojsvet.jar&#34;</span> <span style="color:#007">basedir=</span><span style="background-color:#e0e0ff">&#34;build/classes&#34;</span><span style="color:#070">&gt;</span>
       <span style="color:#070">&lt;manifest&gt;</span>
          <span style="color:#070">&lt;attribute</span> <span style="color:#007">name=</span><span style="background-color:#e0e0ff">&#34;Main-Class&#34;</span> <span style="color:#007">value=</span><span style="background-color:#e0e0ff">&#34;oata.AhojSvet&#34;</span><span style="color:#070">/&gt;</span>
          <span style="color:#070">&lt;/manifest&gt;</span>
    <span style="color:#070">&lt;/jar&gt;</span>
  <span style="color:#070">&lt;/target&gt;</span>

  <span style="color:#070">&lt;target</span> <span style="color:#007">name=</span><span style="background-color:#e0e0ff">&#34;run&#34;</span><span style="color:#070">&gt;</span>
    <span style="color:#070">&lt;java</span> <span style="color:#007">jar=</span><span style="background-color:#e0e0ff">&#34;build/jar/HelloWorld.jar&#34;</span> <span style="color:#007">fork=</span><span style="background-color:#e0e0ff">&#34;true&#34;</span><span style="color:#070">/&gt;</span>
  <span style="color:#070">&lt;/target&gt;</span>

<span style="color:#070">&lt;/project&gt;</span></code></pre></div>
<p>Skompilovať, zabaliť a spustiť aplikáciu môžeme pomocou</p>

<pre><code>ant compile
ant jar
ant run
</code></pre>

<p>alebo na jeden riadok</p>

<pre><code>ant compile jar run
</code></pre>

<p>Ak sa pozrieme na zostavovací súbor, hneď uvidíme podobnosť
medzi direktívami Antu a krokmi, ktoré sme vykonávali z príkazového riadku.</p>

<h3 id="vytvorenie-adresárov">Vytvorenie adresárov</h3>

<pre><code>md build\classes
</code></pre>

<p>zodpovedá príkazu</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#070">&lt;mkdir</span> <span style="color:#007">dir=</span><span style="background-color:#e0e0ff">&#34;build/classes&#34;</span><span style="color:#070">/&gt;</span></code></pre></div>
<p><strong>Pozn.</strong> Príkazy sa v Ante nazývaju <em>úlohami</em> (t<em>asks</em>).</p>

<h3 id="kompilácia">Kompilácia</h3>

<p>Proces kompilácie, ktorý z príkazového riadku dosiahneme cez:</p>

<pre><code>javac
  -sourcepath src
  -d build\classes
  src\oata\HelloWorld.java
</code></pre>

<p>(celý príkaz musí byť na jednom riadku!) je možné dosiahnuť taskom <code>javac</code>.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#070">&lt;javac</span>
  <span style="color:#007">srcdir=</span><span style="background-color:#e0e0ff">&#34;src&#34;</span>
  <span style="color:#007">destdir=</span><span style="background-color:#e0e0ff">&#34;build/classes&#34;</span><span style="color:#070">/&gt;</span></code></pre></div>
<p>Všimnime si, že task <code>javac</code> automaticky detekuje všetky triedy, ktoré
treba prekompilovať. Nie je nutné explicitne vymenovávať zdrojové súbory tried.</p>

<p>Vytvorenie <code>manifest</code>u vyzeralo</p>

<pre><code>echo Main-Class: oata.AhojSvet&gt;mf
</code></pre>

<p>čo možno nakonfigurovať neskôr vo fáze vytvárania JAR súboru.</p>

<h3 id="vytvorenie-jar-súboru">Vytvorenie JAR súboru</h3>

<p>To prebiehalo predtým pomocou:</p>

<pre><code>md build\jar
jar cfm
    build\jar\HelloWorld.jar
    mf
    -C build\classes
    .
</code></pre>

<p>(Celý príkaz je na jednom riadku!) V Ante použijeme na to príslušnú dvojicu taskov</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#070">&lt;mkdir</span> <span style="color:#007">dir=</span><span style="background-color:#e0e0ff">&#34;build/jar&#34;</span><span style="color:#070">/&gt;</span>
<span style="color:#070">&lt;jar</span>
  <span style="color:#007">destfile=</span><span style="background-color:#e0e0ff">&#34;build/jar/ahojsvet.jar&#34;</span>
  <span style="color:#007">basedir=</span><span style="background-color:#e0e0ff">&#34;build/classes&#34;</span><span style="color:#070">&gt;</span>
  <span style="color:#070">&lt;manifest&gt;</span>
    <span style="color:#070">&lt;attribute</span> <span style="color:#007">name=</span><span style="background-color:#e0e0ff">&#34;Main-Class&#34;</span> 
               <span style="color:#007">value=</span><span style="background-color:#e0e0ff">&#34;oata.AhojSvet&#34;</span><span style="color:#070">/&gt;</span>
  <span style="color:#070">&lt;/manifest&gt;</span>
<span style="color:#070">&lt;/jar&gt;</span></code></pre></div>
<p>Task <code>jar</code> uloží do súboru nastaveného v <code>destfile</code> všetky súbory v adresári nastavenom v <code>basedir</code>.</p>

<h3 id="spustenie">Spustenie</h3>

<p>Záverečné spustenie, ktoré z príkazového riadku prebehlo cez</p>

<pre><code>java -jar build\jar\HelloWorld.jar
</code></pre>

<p>je možné zrealizovať cez</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#070">&lt;java</span> <span style="color:#007">jar=</span><span style="background-color:#e0e0ff">&#34;build/jar/ahojsvet.jar&#34;</span> <span style="color:#007">fork=</span><span style="background-color:#e0e0ff">&#34;true&#34;</span><span style="color:#070">/&gt;</span></code></pre></div>
<h2 id="vylepšenie-zostavovacieho-súboru">Vylepšenie zostavovacieho súboru</h2>

<p>Podarilo sa nám vytvoriť prvý funkčný zostavovací súbor. Ale je tu samozrejme množstvo
priestoru na vylepšenie. Častokrát sa stáva, že je potrebné sa odkazovať
na jeden a ten istý adresár na viacerých miestach, špecifikovať názvy výstupných
adresárov a súborov. Zatiaľ sme ich špecifikovali „natvrdo&rdquo; ako konštanty, čo však nemusí byť
vždy ideálny stav.</p>

<p>Ďalším nedostatkom nášho súboru je nutnosť pamätať si správne poradie zostavovacích krokov.</p>

<p>Prvý nedostatok odstránime pomocou tzv. <em>properties</em> (<em>parametrických hodnôt</em>).
Poradie cieľov je možné vyriešiť pomocou závislostí.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#070">&lt;project</span> <span style="color:#007">name=</span><span style="background-color:#e0e0ff">&#34;ahojsvet&#34;</span> <span style="color:#007">basedir=</span><span style="background-color:#e0e0ff">&#34;.&#34;</span> <span style="color:#007">default=</span><span style="background-color:#e0e0ff">&#34;main&#34;</span><span style="color:#070">&gt;</span>

  <span style="color:#070">&lt;property</span> <span style="color:#007">name=</span><span style="background-color:#e0e0ff">&#34;src.dir&#34;</span>     <span style="color:#007">value=</span><span style="background-color:#e0e0ff">&#34;src&#34;</span><span style="color:#070">/&gt;</span>

  <span style="color:#070">&lt;property</span> <span style="color:#007">name=</span><span style="background-color:#e0e0ff">&#34;build.dir&#34;</span>   <span style="color:#007">value=</span><span style="background-color:#e0e0ff">&#34;build&#34;</span><span style="color:#070">/&gt;</span>
  <span style="color:#070">&lt;property</span> <span style="color:#007">name=</span><span style="background-color:#e0e0ff">&#34;classes.dir&#34;</span> <span style="color:#007">value=</span><span style="background-color:#e0e0ff">&#34;${build.dir}/classes&#34;</span><span style="color:#070">/&gt;</span>
  <span style="color:#070">&lt;property</span> <span style="color:#007">name=</span><span style="background-color:#e0e0ff">&#34;jar.dir&#34;</span>     <span style="color:#007">value=</span><span style="background-color:#e0e0ff">&#34;${build.dir}/jar&#34;</span><span style="color:#070">/&gt;</span>

  <span style="color:#070">&lt;property</span> <span style="color:#007">name=</span><span style="background-color:#e0e0ff">&#34;main-class&#34;</span>  <span style="color:#007">value=</span><span style="background-color:#e0e0ff">&#34;oata.AhojSvet&#34;</span><span style="color:#070">/&gt;</span>

  <span style="color:#070">&lt;target</span> <span style="color:#007">name=</span><span style="background-color:#e0e0ff">&#34;clean&#34;</span><span style="color:#070">&gt;</span>
    <span style="color:#070">&lt;delete</span> <span style="color:#007">dir=</span><span style="background-color:#e0e0ff">&#34;${build.dir}&#34;</span><span style="color:#070">/&gt;</span>
  <span style="color:#070">&lt;/target&gt;</span>

  <span style="color:#070">&lt;target</span> <span style="color:#007">name=</span><span style="background-color:#e0e0ff">&#34;compile&#34;</span><span style="color:#070">&gt;</span>
    <span style="color:#070">&lt;mkdir</span> <span style="color:#007">dir=</span><span style="background-color:#e0e0ff">&#34;${classes.dir}&#34;</span><span style="color:#070">/&gt;</span>
     <span style="color:#070">&lt;javac</span> <span style="color:#007">srcdir=</span><span style="background-color:#e0e0ff">&#34;${src.dir}&#34;</span> <span style="color:#007">destdir=</span><span style="background-color:#e0e0ff">&#34;${classes.dir}&#34;</span><span style="color:#070">/&gt;</span>
  <span style="color:#070">&lt;/target&gt;</span>

  <span style="color:#070">&lt;target</span> <span style="color:#007">name=</span><span style="background-color:#e0e0ff">&#34;jar&#34;</span> <span style="color:#007">depends=</span><span style="background-color:#e0e0ff">&#34;compile&#34;</span><span style="color:#070">&gt;</span>
    <span style="color:#070">&lt;mkdir</span> <span style="color:#007">dir=</span><span style="background-color:#e0e0ff">&#34;${jar.dir}&#34;</span><span style="color:#070">/&gt;</span>
    <span style="color:#070">&lt;jar</span> <span style="color:#007">destfile=</span><span style="background-color:#e0e0ff">&#34;${jar.dir}/${ant.project.name}.jar&#34;</span> 
         <span style="color:#007">basedir=</span><span style="background-color:#e0e0ff">&#34;${classes.dir}&#34;</span><span style="color:#070">&gt;</span>
         
      <span style="color:#070">&lt;manifest&gt;</span>
        <span style="color:#070">&lt;attribute</span> <span style="color:#007">name=</span><span style="background-color:#e0e0ff">&#34;Main-Class&#34;</span> <span style="color:#007">value=</span><span style="background-color:#e0e0ff">&#34;${main-class}&#34;</span><span style="color:#070">/&gt;</span>
      <span style="color:#070">&lt;/manifest&gt;</span>
      
    <span style="color:#070">&lt;/jar&gt;</span>
  <span style="color:#070">&lt;/target&gt;</span>

  <span style="color:#070">&lt;target</span> <span style="color:#007">name=</span><span style="background-color:#e0e0ff">&#34;run&#34;</span> <span style="color:#007">depends=</span><span style="background-color:#e0e0ff">&#34;jar&#34;</span><span style="color:#070">&gt;</span>
    <span style="color:#070">&lt;java</span> <span style="color:#007">jar=</span><span style="background-color:#e0e0ff">&#34;${jar.dir}/${ant.project.name}.jar&#34;</span> <span style="color:#007">fork=</span><span style="background-color:#e0e0ff">&#34;true&#34;</span><span style="color:#070">/&gt;</span>
  <span style="color:#070">&lt;/target&gt;</span>

  <span style="color:#070">&lt;target</span> <span style="color:#007">name=</span><span style="background-color:#e0e0ff">&#34;clean-build&#34;</span> <span style="color:#007">depends=</span><span style="background-color:#e0e0ff">&#34;clean,jar&#34;</span><span style="color:#070">/&gt;</span>

  <span style="color:#070">&lt;target</span> <span style="color:#007">name=</span><span style="background-color:#e0e0ff">&#34;main&#34;</span> <span style="color:#007">depends=</span><span style="background-color:#e0e0ff">&#34;clean,run&#34;</span><span style="color:#070">/&gt;</span>
  
<span style="color:#070">&lt;/project&gt;</span></code></pre></div>
<h3 id="premenné">Premenné</h3>

<p>V elemente <code>project</code> pribudlo niekoľko elementov:</p>

<ul>
<li><code>name=&quot;ahojsvet&quot;</code> špecifikuje názov projektu.</li>
<li><code>basedir=&quot;.&quot;</code> určuje základný adresár, od ktorého sa budú odvíjať relatívne cesty. V tomto prípade je ním adresár, z ktorého sa spustí zostavovací proces</li>
<li><code>default=&quot;main&quot;</code> uvádza, že implicitným cieľom bude cieľ <code>main</code>. Ak
pri spúšťaní Antu neuvedieme žiadny cieľ, automaticky sa spustí implicitný cieľ.</li>
</ul>

<p>Ďalej sme špecifikovali niekoľko <code>properties</code>, čo je vlastne analógia premenných</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#070">&lt;property</span> <span style="color:#007">name=</span><span style="background-color:#e0e0ff">&#34;build.dir&#34;</span>   <span style="color:#007">value=</span><span style="background-color:#e0e0ff">&#34;build&#34;</span><span style="color:#070">/&gt;</span>
<span style="color:#070">&lt;property</span> <span style="color:#007">name=</span><span style="background-color:#e0e0ff">&#34;classes.dir&#34;</span> <span style="color:#007">value=</span><span style="background-color:#e0e0ff">&#34;${build.dir}/classes&#34;</span><span style="color:#070">/&gt;</span>
<span style="color:#070">&lt;property</span> <span style="color:#007">name=</span><span style="background-color:#e0e0ff">&#34;jar.dir&#34;</span>     <span style="color:#007">value=</span><span style="background-color:#e0e0ff">&#34;${build.dir}/jar&#34;</span><span style="color:#070">/&gt;</span></code></pre></div>
<p>Všimnime si, že v hodnotách premenných sa môžeme odkazovať na hodnoty
už existujúcich premenných. Premenná <code>jar.dir</code> teda bude
obsahovať hodnotu <code>build/jar</code>.</p>

<p>V samotnom <code>build.xml</code> už existuje niekoľko preddefinovaných premenných.
Napr. <code>${ant.project.name}</code> obsahuje názov projektu z atribútu
<code>name</code> v elemente <code>project</code>.</p>

<h3 id="závislosti">Závislosti</h3>

<p>Splnenie každého z cieľov môže vyžadovať úspešné splnenie iných cieľov.
Napr. vytvorenie JAR súboru závisí na úspešnom skompilovaní zdrojákov.
Závislosti možno udávať pomocou atribútu <code>depends</code> v elemente <code>target</code>.</p>

<p>Cieľ <code>main</code> závisí na postupnom úspešnom skončení cieľov <code>clean</code> a <code>run</code>.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#070">&lt;target</span> <span style="color:#007">name=</span><span style="background-color:#e0e0ff">&#34;main&#34;</span> <span style="color:#007">depends=</span><span style="background-color:#e0e0ff">&#34;clean,run&#34;</span><span style="color:#070">/&gt;</span></code></pre></div>
<h3 id="spustenie-1">Spustenie</h3>

<p>Ak teraz spustíme</p>

<pre><code>ant
</code></pre>

<p>získame nasledovný výpis:</p>

<pre><code>Buildfile: build.xml

clean:

compile:
    [mkdir] Created dir: C:\...\build\classes
    [javac] Compiling 1 source file to C:\...\build\classes

jar:
    [mkdir] Created dir: C:\...\build\jar
      [jar] Building jar: C:\...\build\jar\ahojsvet.jar

run:
     [java] Ahoj svet!

main:

BUILD SUCCESSFUL
</code></pre>

<h2 id="používanie-externých-knižníc-v-projekte">Používanie externých knižníc v projekte</h2>

<p>Váš šéf sa jedného dňa rozhodol zakázať používanie <code>System.out.println()</code>
a určil, že na ladiace výpisy sa bude používať niektoré z existujúcich
knižníc. (Výhoda takéhoto postupu je napr. možnosť filtrovať výpisy
podľa dôležitosti alebo úplne vypnutie výpisu, čo <code>System.out</code> nedovoľuje.)</p>

<p>V príklade budeme používať <a href="http://logging.apache.org/log4j/">Log4j</a>, pretože</p>

<ul>
<li>nie je súčasťou JDK a hoci by sme mohli použiť <code>java.util.logging</code>, neurobíme to, pretože chceme demonštrovať externé knižnice</li>
<li>beží aj pod JDK 1.2 (podobne ako Ant)</li>
<li>má široké možnosti konfigurovania</li>
<li>je od Apache-a ;-)</li>
</ul>

<p>V našom projekte budeme ukladať externé knižnice do nového adresára <code>lib</code>.
Log4j je možné stiahnuť z <a href="http://www.apache.org/dist/logging/log4j/">domovskej stránky</a>. Vytvoríme teda adresár <code>lib</code> a vložíme doň JAR súbor
s log4j (typicky ide o súbor <code>log4j-1.2.14.jar</code>). Následne upravíme
našu triedu tak, aby používala na ladiace výpisy túto knižnicu a
modifikujeme zostavovací súbor tak, aby bola knižnica k dispozícii pri kompilácii
a spustení.</p>

<p>Postup práce s log4j je uvedený v príslušnej dokumentácii. My použijeme
minimalistickú verziu triedy, ktorá bude vyzerať nasledovne:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#289;font-weight:bold">package</span> <span style="color:#5ed;font-weight:bold">oata</span>;

<span style="color:#289;font-weight:bold">import</span> <span style="color:#5ed;font-weight:bold">org</span>.<span style="color:#007">apache</span>.<span style="color:#007">log4j</span>.<span style="color:#007">Logger</span>;
<span style="color:#289;font-weight:bold">import</span> <span style="color:#5ed;font-weight:bold">org</span>.<span style="color:#007">apache</span>.<span style="color:#007">log4j</span>.<span style="color:#007">BasicConfigurator</span>;

<span style="color:#289;font-weight:bold">public</span> <span style="color:#5ed;font-weight:bold">class</span> AhojSvet {
    <span style="color:#289;font-weight:bold">static</span> <span style="color:#5ed;font-weight:bold">Logger</span> logger <span style="color:#333">=</span> Logger.<span style="color:#007">getLogger</span>(HelloWorld.<span style="color:#007">class</span>);

    <span style="color:#289;font-weight:bold">public</span> <span style="color:#5ed;font-weight:bold">static</span> <span style="color:#66f;font-weight:bold">void</span> <span style="color:#5ed;font-weight:bold">main</span>(String[] <span style="color:#5ed;font-weight:bold">args</span>) {
        BasicConfigurator.<span style="color:#007">configure</span>();
        logger.<span style="color:#007">info</span>(<span style="background-color:#e0e0ff">&#34;Ahoj svet!&#34;</span>);  
    }
}</code></pre></div>
<p>Väčšina úprav pozostáva z dodania náležitostí vyžadovaných
ladiacou knižnicou a z inicializácie systému pre výpisy.
Riadok <code>logger.info()</code> je analógiou <code>System.out.println()</code>.</p>

<p>Ak by ste spustili Ant hneď teraz, získali by ste len hŕbu
kompilačných chýb poukazujúcich na neprítomnosť
tried z Log4j. Ten sa totiž nenachádza v <code>CLASSPATH</code>.</p>

<p>Základným riešením <em>ťažkého kalibru</em> je pridanie JAR súboru
s <code>log4j</code> do systémovej premennej <code>CLASSPATH</code>. To však
veľmi neodporúčame, keďže sa tým môže narušiť funkcionalita
iných Java aplikácií. Navyše, táto verzia log4j
má význam len pre náš projekt a bolo by príliš zbytočné
nanucovať ho pre celý systém.</p>

<p>Závislosť na log4j zavedieme do zostavovacieho súboru nasledovne:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#070">&lt;project</span> <span style="color:#007">name=</span><span style="background-color:#e0e0ff">&#34;HelloWorld&#34;</span> <span style="color:#007">basedir=</span><span style="background-color:#e0e0ff">&#34;.&#34;</span> <span style="color:#007">default=</span><span style="background-color:#e0e0ff">&#34;main&#34;</span><span style="color:#070">&gt;</span>
    ...
    <span style="color:#070">&lt;property</span> <span style="color:#007">name=</span><span style="background-color:#e0e0ff">&#34;lib.dir&#34;</span>     <span style="color:#007">value=</span><span style="background-color:#e0e0ff">&#34;lib&#34;</span><span style="color:#070">/&gt;</span>

    <span style="color:#070">&lt;path</span> <span style="color:#007">id=</span><span style="background-color:#e0e0ff">&#34;lib.classpath&#34;</span><span style="color:#070">&gt;</span>
        <span style="color:#070">&lt;fileset</span> <span style="color:#007">dir=</span><span style="background-color:#e0e0ff">&#34;${lib.dir}&#34;</span> <span style="color:#007">includes=</span><span style="background-color:#e0e0ff">&#34;**/*.jar&#34;</span><span style="color:#070">/&gt;</span>
    <span style="color:#070">&lt;/path&gt;</span>

    ...

    <span style="color:#070">&lt;target</span> <span style="color:#007">name=</span><span style="background-color:#e0e0ff">&#34;compile&#34;</span><span style="color:#070">&gt;</span>
        <span style="color:#070">&lt;mkdir</span> <span style="color:#007">dir=</span><span style="background-color:#e0e0ff">&#34;${classes.dir}&#34;</span><span style="color:#070">/&gt;</span>
        <span style="color:#070">&lt;javac</span> <span style="color:#007">srcdir=</span><span style="background-color:#e0e0ff">&#34;${src.dir}&#34;</span> 
               <span style="color:#007">destdir=</span><span style="background-color:#e0e0ff">&#34;${classes.dir}&#34;</span> 
               <span style="color:#007">classpathref=</span><span style="background-color:#e0e0ff">&#34;lib.classpath&#34;</span><span style="color:#070">/&gt;</span>
    <span style="color:#070">&lt;/target&gt;</span>

    <span style="color:#070">&lt;target</span> <span style="color:#007">name=</span><span style="background-color:#e0e0ff">&#34;run&#34;</span> <span style="color:#007">depends=</span><span style="background-color:#e0e0ff">&#34;jar&#34;</span><span style="color:#070">&gt;</span>
        <span style="color:#070">&lt;java</span> <span style="color:#007">fork=</span><span style="background-color:#e0e0ff">&#34;true&#34;</span> <span style="color:#007">classname=</span><span style="background-color:#e0e0ff">&#34;${main-class}&#34;</span><span style="color:#070">&gt;</span>
            <span style="color:#070">&lt;classpath&gt;</span>
                <span style="color:#070">&lt;path</span> <span style="color:#007">refid=</span><span style="background-color:#e0e0ff">&#34;lib.classpath&#34;</span><span style="color:#070">/&gt;</span>
                <span style="color:#070">&lt;path</span> <span style="color:#007">location=</span><span style="background-color:#e0e0ff">&#34;${jar.dir}/${ant.project.name}.jar&#34;</span><span style="color:#070">/&gt;</span>
            <span style="color:#070">&lt;/classpath&gt;</span>
        <span style="color:#070">&lt;/java&gt;</span>
    <span style="color:#070">&lt;/target&gt;</span>

    ...

<span style="color:#070">&lt;/project&gt;</span></code></pre></div>
<p>Predovšetkým sme definovali novú <em>property</em> pre adresár s knižnicami.
Direktíva <code>path</code> umožňuje definovať a logicky pomenovať množinu súborov a adresárov.
V operačnom systéme by ste <code>CLASSPATH</code> zaviedli ako zoznam adresárov/súborov
oddelených čiarkami, v Ante je to možné docieliť definovaným pomocou tejto direktívy.</p>

<p>V našom prípade sme definovali logickú množinu súborov a adresárov pod názvom
<code>lib.classpath</code>, ktorá bude obsahovať všetky JAR súbory v adresári a podadresároch
adresára <code>lib</code>.</p>

<p>Knižnicu je potrebné zaviesť pri kompilovaní:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#070">&lt;javac</span> <span style="color:#007">srcdir=</span><span style="background-color:#e0e0ff">&#34;${src.dir}&#34;</span> <span style="color:#007">destdir=</span><span style="background-color:#e0e0ff">&#34;${classes.dir}&#34;</span> 
       <span style="color:#007">classpathref=</span><span style="background-color:#e0e0ff">&#34;lib.classpath&#34;</span><span style="color:#070">/&gt;</span></code></pre></div>
<p>Atribút <code>classpathref</code> sa odkazuje na súbory a adresáre špecifikované
v množine s názvom <code>lib.classpath</code>.</p>

<p>Pri spustení použijeme element <code>classpath</code>, kde uvedieme
jednak súbory a adresáre z cesty <code>lib.classpath</code> a jednak
výsledný JAR súbor:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#070">&lt;java</span> <span style="color:#007">fork=</span><span style="background-color:#e0e0ff">&#34;true&#34;</span> <span style="color:#007">classname=</span><span style="background-color:#e0e0ff">&#34;${main-class}&#34;</span><span style="color:#070">&gt;</span>
  <span style="color:#070">&lt;classpath&gt;</span>
     <span style="color:#070">&lt;path</span> <span style="color:#007">refid=</span><span style="background-color:#e0e0ff">&#34;lib.classpath&#34;</span><span style="color:#070">/&gt;</span>
     <span style="color:#070">&lt;path</span> <span style="color:#007">location=</span><span style="background-color:#e0e0ff">&#34;${jar.dir}/${ant.project.name}.jar&#34;</span><span style="color:#070">/&gt;</span>
  <span style="color:#070">&lt;/classpath&gt;</span>
<span style="color:#070">&lt;/java&gt;</span></code></pre></div>
<p>V tomto prípade by sme nemohli spustiť aplikáciu pomocou atribútu
<code>Main-Class</code> z manifestu, pretože Java neumožňuje špecifikovať
pri spustiteľných JAR súboroch CLASSPATH. (Vysvetlenie
viď napr. na <a href="http://ics.upjs.sk/~novotnyr/wiki/Java.ClasspathAClassNotFoundException)">http://ics.upjs.sk/~novotnyr/wiki/Java.ClasspathAClassNotFoundException)</a></p>

<p>Preto potrebujeme pri tasku <code>java</code> špecifikovať <code>CLASSPATH</code> explicitne.</p>

<p>Spustením Antu získame (okrem iného) výpis</p>

<pre><code>[java] 0 [main] INFO oata.AhojSvet - Ahoj Svet!
</code></pre>

<p>Tento riadok znamená:</p>

<ul>
<li><code>[java]</code> &ndash; aktuálny bežiaci task Antu</li>
<li><code>0</code> &ndash; počet sekúnd od spustenia programu</li>
<li><code>[main]</code> &ndash; názov vlákna, pod ktorým beží aplikácia</li>
<li><code>INFO</code> &ndash; priorita ladiaceho hlásenia</li>
<li><code>oata.AhojSvet</code> &ndash; trieda, v ktorej nastalo hlásenie</li>
<li><code>-</code> oddeľovač</li>
<li><code>Ahoj svet!</code> &ndash; text hlásenia</li>
</ul>

<h2 id="konfiguračné-súbory">Konfiguračné súbory</h2>

<p>Jedným z dôvodov na použitie Log4j boli „široké možnosti konfigurácie&rdquo;.
Ale v našom príklade sme mali všetky možnosti na formát výpisu uvedené natvrdo!
To však nie je chyba log4j, ale nášho prístupu. Riadok</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">BasicConfigurator.<span style="color:#007">configure</span>()</code></pre></div>
<p>nastaví pre ladiace výpisy jednoduchý, lež pevne daný formát. Často je však
potrebné prispôsobenie s využitím konfiguračného súboru.</p>

<p>Odstráňme z triedy tento riadok (a príslušné importy). Log4j sa potom
bude pokúšať hľadať nastavenie pre konfiguráciu - štandardným spôsobom
je vyhľadanie súboru <code>log4j.properties</code> v <code>CLASSPATH</code> a jeho použitie
pre konfiguráciu formátu výpisov. Vytvoríme teda súbor <code>src\log4j.properties</code>.</p>

<pre><code>log4j.rootLogger=DEBUG, stdout

log4j.appender.stdout=org.apache.log4j.ConsoleAppender

log4j.appender.stdout.layout=org.apache.log4j.PatternLayout
log4j.appender.stdout.layout.ConversionPattern=%m%n
</code></pre>

<p>Tento súbor definuje jeden výstupný kanál (<em>appender</em>) pre ladiace hlásenia
pod logickým označením <code>stdout</code>. Tento kanál bude posielať hlásenia
na štandardný výstup, pričom pre každé hlásenie bude vypísaný text (<code>%m</code>)
nasledovaný znakom nového riadku (<code>%n</code>). Týmto nasimulujeme chovanie
<code>System.out.println()</code>. Okrem toho nastavíme, že všetky hlásenia
priority <code>DEBUG</code> a vyššej budú posielané na kanál <code>stdout</code>.</p>

<p>To však nie je všetko. Konfiguračný súbor sa totiž musí nachádzať v <code>CLASSPATH</code>.
To docielime skopírovaním tohto súboru do adresára, v ktorom sa nachádzajú
skompilované triedy a teda výhodným použitím tasku <code>copy</code>.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml">...
<span style="color:#070">&lt;target</span> <span style="color:#007">name=</span><span style="background-color:#e0e0ff">&#34;compile&#34;</span><span style="color:#070">&gt;</span>
    <span style="color:#070">&lt;mkdir</span> <span style="color:#007">dir=</span><span style="background-color:#e0e0ff">&#34;${classes.dir}&#34;</span><span style="color:#070">/&gt;</span>
    <span style="color:#070">&lt;javac</span> <span style="color:#007">srcdir=</span><span style="background-color:#e0e0ff">&#34;${src.dir}&#34;</span> <span style="color:#007">destdir=</span><span style="background-color:#e0e0ff">&#34;${classes.dir}&#34;</span> <span style="color:#007">classpathref=</span><span style="background-color:#e0e0ff">&#34;lib.classpath&#34;</span><span style="color:#070">/&gt;</span>
    <span style="color:#070">&lt;copy</span> <span style="color:#007">todir=</span><span style="background-color:#e0e0ff">&#34;${classes.dir}&#34;</span><span style="color:#070">&gt;</span>
        <span style="color:#070">&lt;fileset</span> <span style="color:#007">dir=</span><span style="background-color:#e0e0ff">&#34;${src.dir}&#34;</span> <span style="color:#007">excludes=</span><span style="background-color:#e0e0ff">&#34;**/*.java&#34;</span><span style="color:#070">/&gt;</span>
    <span style="color:#070">&lt;/copy&gt;</span>
<span style="color:#070">&lt;/target&gt;</span>
...</code></pre></div>
<p>Task <code>copy</code> skopíruje všetky súbory, ktoré nemajú príponu <code>.java</code> z adresára
pre zdrojové súbory do adresára pre triedy.</p>

<p>To nám umožní korektne spustiť aplikáciu a rovnako pribaľovať <code>log4j.properties</code>
do JAR súboru.</p>

<h1 id="ďalší-príklad-reálneho-zostavovacieho-súboru">Ďalší príklad reálneho zostavovacieho súboru</h1>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#579">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span style="color:#070">&lt;project</span> <span style="color:#007">name=</span><span style="background-color:#e0e0ff">&#34;davano&#34;</span> <span style="color:#007">basedir=</span><span style="background-color:#e0e0ff">&#34;.&#34;</span> <span style="color:#007">default=</span><span style="background-color:#e0e0ff">&#34;build&#34;</span><span style="color:#070">&gt;</span>
  <span style="color:#070">&lt;property</span> <span style="color:#007">name=</span><span style="background-color:#e0e0ff">&#34;build&#34;</span>       <span style="color:#007">location=</span><span style="background-color:#e0e0ff">&#34;build&#34;</span><span style="color:#070">/&gt;</span>
  <span style="color:#070">&lt;property</span> <span style="color:#007">name=</span><span style="background-color:#e0e0ff">&#34;build.classes&#34;</span> <span style="color:#007">location=</span><span style="background-color:#e0e0ff">&#34;build/classes&#34;</span><span style="color:#070">/&gt;</span>
  <span style="color:#070">&lt;property</span> <span style="color:#007">name=</span><span style="background-color:#e0e0ff">&#34;build.src&#34;</span>     <span style="color:#007">location=</span><span style="background-color:#e0e0ff">&#34;build/src&#34;</span><span style="color:#070">/&gt;</span>
  <span style="color:#070">&lt;property</span> <span style="color:#007">name=</span><span style="background-color:#e0e0ff">&#34;src&#34;</span>           <span style="color:#007">location=</span><span style="background-color:#e0e0ff">&#34;src&#34;</span><span style="color:#070">/&gt;</span>
  <span style="color:#070">&lt;property</span> <span style="color:#007">name=</span><span style="background-color:#e0e0ff">&#34;server.src&#34;</span>    <span style="color:#007">location=</span><span style="background-color:#e0e0ff">&#34;etc/server&#34;</span><span style="color:#070">/&gt;</span>

  <span style="color:#070">&lt;path</span> <span style="color:#007">id=</span><span style="background-color:#e0e0ff">&#34;servlet-api.classpath&#34;</span><span style="color:#070">&gt;</span>
    <span style="color:#070">&lt;fileset</span> <span style="color:#007">dir=</span><span style="background-color:#e0e0ff">&#34;c:\java\tomcat-6\lib&#34;</span><span style="color:#070">&gt;</span>
      <span style="color:#070">&lt;include</span> <span style="color:#007">name=</span><span style="background-color:#e0e0ff">&#34;servlet-api.jar&#34;</span><span style="color:#070">/&gt;</span>
      <span style="color:#070">&lt;include</span> <span style="color:#007">name=</span><span style="background-color:#e0e0ff">&#34;jsp-api.jar&#34;</span><span style="color:#070">/&gt;</span>
    <span style="color:#070">&lt;/fileset&gt;</span>
  <span style="color:#070">&lt;/path&gt;</span>

  <span style="color:#070">&lt;path</span> <span style="color:#007">id=</span><span style="background-color:#e0e0ff">&#34;project.classpath&#34;</span><span style="color:#070">&gt;</span>
    <span style="color:#070">&lt;fileset</span> <span style="color:#007">dir=</span><span style="background-color:#e0e0ff">&#34;web/WEB-INF/lib&#34;</span><span style="color:#070">&gt;</span>
      <span style="color:#070">&lt;include</span> <span style="color:#007">name=</span><span style="background-color:#e0e0ff">&#34;*.jar&#34;</span><span style="color:#070">/&gt;</span>
    <span style="color:#070">&lt;/fileset&gt;</span>
  <span style="color:#070">&lt;/path&gt;</span>

  <span style="color:#070">&lt;target</span> <span style="color:#007">name=</span><span style="background-color:#e0e0ff">&#34;clean&#34;</span><span style="color:#070">&gt;</span>
    <span style="color:#070">&lt;delete</span> <span style="color:#007">dir=</span><span style="background-color:#e0e0ff">&#34;${build.classes}&#34;</span> <span style="color:#070">/&gt;</span>
    <span style="color:#070">&lt;delete</span> <span style="color:#007">dir=</span><span style="background-color:#e0e0ff">&#34;${build.src}&#34;</span> <span style="color:#070">/&gt;</span>
  <span style="color:#070">&lt;/target&gt;</span>

  <span style="color:#070">&lt;target</span> <span style="color:#007">name=</span><span style="background-color:#e0e0ff">&#34;prepare&#34;</span><span style="color:#070">&gt;</span>
    <span style="color:#070">&lt;mkdir</span> <span style="color:#007">dir=</span><span style="background-color:#e0e0ff">&#34;${build.classes}&#34;</span> <span style="color:#070">/&gt;</span>
    <span style="color:#070">&lt;mkdir</span> <span style="color:#007">dir=</span><span style="background-color:#e0e0ff">&#34;${build.src}&#34;</span> <span style="color:#070">/&gt;</span>
  <span style="color:#070">&lt;/target&gt;</span>

  <span style="color:#070">&lt;target</span> <span style="color:#007">name=</span><span style="background-color:#e0e0ff">&#34;prepare-src&#34;</span><span style="color:#070">&gt;</span>
    <span style="color:#070">&lt;copy</span> <span style="color:#007">todir=</span><span style="background-color:#e0e0ff">&#34;${build.src}&#34;</span><span style="color:#070">&gt;</span>
      <span style="color:#070">&lt;fileset</span> <span style="color:#007">dir=</span><span style="background-color:#e0e0ff">&#34;${src}&#34;</span><span style="color:#070">&gt;</span>
        <span style="color:#070">&lt;include</span> <span style="color:#007">name=</span><span style="background-color:#e0e0ff">&#34;**&#34;</span><span style="color:#070">/&gt;</span>
      <span style="color:#070">&lt;/fileset&gt;</span>
    <span style="color:#070">&lt;/copy&gt;</span>
  <span style="color:#070">&lt;/target&gt;</span>


  <span style="color:#070">&lt;target</span> <span style="color:#007">name=</span><span style="background-color:#e0e0ff">&#34;copy-config&#34;</span><span style="color:#070">&gt;</span>
    <span style="color:#070">&lt;copy</span> <span style="color:#007">todir=</span><span style="background-color:#e0e0ff">&#34;${build.classes}&#34;</span> <span style="color:#007">overwrite=</span><span style="background-color:#e0e0ff">&#34;yes&#34;</span><span style="color:#070">&gt;</span>
      <span style="color:#070">&lt;fileset</span> <span style="color:#007">dir=</span><span style="background-color:#e0e0ff">&#34;src&#34;</span><span style="color:#070">&gt;</span>
        <span style="color:#070">&lt;exclude</span> <span style="color:#007">name=</span><span style="background-color:#e0e0ff">&#34;*.java&#34;</span><span style="color:#070">/&gt;</span>
      <span style="color:#070">&lt;/fileset&gt;</span>
    <span style="color:#070">&lt;/copy&gt;</span>
  <span style="color:#070">&lt;/target&gt;</span>

  <span style="color:#070">&lt;target</span> <span style="color:#007">name=</span><span style="background-color:#e0e0ff">&#34;copy-server-config&#34;</span><span style="color:#070">&gt;</span>
    <span style="color:#070">&lt;copy</span> <span style="color:#007">todir=</span><span style="background-color:#e0e0ff">&#34;${build.classes}&#34;</span> <span style="color:#007">overwrite=</span><span style="background-color:#e0e0ff">&#34;yes&#34;</span><span style="color:#070">&gt;</span>
      <span style="color:#070">&lt;fileset</span> <span style="color:#007">dir=</span><span style="background-color:#e0e0ff">&#34;${server.src}&#34;</span><span style="color:#070">&gt;</span>
        <span style="color:#070">&lt;include</span> <span style="color:#007">name=</span><span style="background-color:#e0e0ff">&#34;**&#34;</span><span style="color:#070">/&gt;</span>
      <span style="color:#070">&lt;/fileset&gt;</span>
    <span style="color:#070">&lt;/copy&gt;</span>
  <span style="color:#070">&lt;/target&gt;</span>


  <span style="color:#070">&lt;target</span> <span style="color:#007">name=</span><span style="background-color:#e0e0ff">&#34;javac&#34;</span> <span style="color:#007">depends=</span><span style="background-color:#e0e0ff">&#34;prepare-src, patch-server-config&#34;</span><span style="color:#070">&gt;</span>
    <span style="color:#070">&lt;javac</span> <span style="color:#007">srcdir=</span><span style="background-color:#e0e0ff">&#34;${build.src}&#34;</span> 
           <span style="color:#007">destdir=</span><span style="background-color:#e0e0ff">&#34;${build.classes}&#34;</span> <span style="color:#007">debug=</span><span style="background-color:#e0e0ff">&#34;on&#34;</span><span style="color:#070">&gt;</span>

      <span style="color:#070">&lt;classpath</span> <span style="color:#007">refid=</span><span style="background-color:#e0e0ff">&#34;project.classpath&#34;</span> <span style="color:#070">/&gt;</span>
      <span style="color:#070">&lt;classpath</span> <span style="color:#007">refid=</span><span style="background-color:#e0e0ff">&#34;servlet-api.classpath&#34;</span> <span style="color:#070">/&gt;</span>
    <span style="color:#070">&lt;/javac&gt;</span>
  <span style="color:#070">&lt;/target&gt;</span>

  <span style="color:#070">&lt;target</span> <span style="color:#007">name=</span><span style="background-color:#e0e0ff">&#34;patch-server-config&#34;</span><span style="color:#070">&gt;</span>
    <span style="color:#070">&lt;replace</span> <span style="color:#007">dir=</span><span style="background-color:#e0e0ff">&#34;${build.src}&#34;</span> 
             <span style="color:#007">includes=</span><span style="background-color:#e0e0ff">&#34;**/*.java&#34;</span> 
             <span style="color:#007">token=</span><span style="background-color:#e0e0ff">&#34;return Application.DEVELOPMENT;&#34;</span> 
             <span style="color:#007">value=</span><span style="background-color:#e0e0ff">&#34;return Application.DEPLOYMENT;&#34;</span><span style="color:#070">&gt;</span>
    <span style="color:#070">&lt;/replace&gt;</span>
  <span style="color:#070">&lt;/target&gt;</span>

  <span style="color:#070">&lt;target</span> <span style="color:#007">name=</span><span style="background-color:#e0e0ff">&#34;jar&#34;</span><span style="color:#070">&gt;</span>
    <span style="color:#070">&lt;tstamp&gt;</span>
      <span style="color:#070">&lt;format</span> <span style="color:#007">property=</span><span style="background-color:#e0e0ff">&#34;timestamp&#34;</span> <span style="color:#007">pattern=</span><span style="background-color:#e0e0ff">&#34;yyyy-dd-MM&#34;</span><span style="color:#070">/&gt;</span>
    <span style="color:#070">&lt;/tstamp&gt;</span>
    <span style="color:#070">&lt;jar</span> <span style="color:#007">basedir=</span><span style="background-color:#e0e0ff">&#34;${build.classes}&#34;</span> 
         <span style="color:#007">destfile=</span><span style="background-color:#e0e0ff">&#34;${build}/${ant.project.name}-${timestamp}.jar&#34;</span>
    <span style="color:#070">/&gt;</span>
  <span style="color:#070">&lt;/target&gt;</span>

  <span style="color:#070">&lt;target</span> <span style="color:#007">name=</span><span style="background-color:#e0e0ff">&#34;build&#34;</span> <span style="color:#007">depends=</span><span style="background-color:#e0e0ff">&#34;clean,prepare,javac,copy-config,copy-server-config,jar&#34;</span> <span style="color:#070">/&gt;</span>
<span style="color:#070">&lt;/project&gt;</span></code></pre></div>
</main>

    <footer>
      
<script>
(function() {
  function center_el(tagName) {
    var tags = document.getElementsByTagName(tagName), i, tag;
    for (i = 0; i < tags.length; i++) {
      tag = tags[i];
      var parent = tag.parentElement;
      
      if (parent.childNodes.length === 1) {
        
        if (parent.nodeName === 'A') {
          parent = parent.parentElement;
          if (parent.childNodes.length != 1) continue;
        }
        if (parent.nodeName === 'P') parent.style.textAlign = 'center';
      }
    }
  }
  var tagNames = ['img', 'embed', 'object'];
  for (var i = 0; i < tagNames.length; i++) {
    center_el(tagNames[i]);
  }
})();
</script>

      
    </footer>
  </body>
</html>

